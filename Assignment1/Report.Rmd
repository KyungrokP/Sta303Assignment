---
title: "An Analysis of effect of literacy and age of a marriage on family size using Portual data"
author: "Kyungrok Park"
date: "Feb 4, 2025"
output:
  pdf_document:
    toc: true
    number_sections: true
---

# Introduction

# Methods

To examine the effects of literacy and age at marriage on family size, this study analyzes two types of regression models: Poisson regression and Negative Binomial regression. Although the temporal component of the response variable, family size, is implicit, it can be interpreted as an accumulation over a woman's reproductive lifetime, making it suitable for modeling as count data within a Poisson framework.

Regarding the explanatory variables, the inclusion of the binary variable (literacy) and the categorical variable (age at marriage) is essential, as they are the primary focus of this research. Additionally, given that in Europe, fertility takes place later and is lower in cities than in rural areas (Riederer & Beaujouan, 2023), another categorical variable, regional population size, is incorporated as a key determinant of urban versus rural classification. Furthermore, in son-preferring societies, such as Korea, smaller families tend to have a higher sex ratio (number of males per 100 females) than larger families (Park, 1983). While it remains uncertain whether Portugal exhibits a strong preference for sons, this study introduces the proportion of sons among children as an additional explanatory variable. This inclusion aims not only to examine the impact of sex composition on family size but also to explore whether the data suggest any indirect indication of son preference in Portugal. Further justification and illustration of the response and  explanatory variables will be discussed in the Introduction section.

In addition to the standard Poisson regression, a Poisson regression with an offset (months since marriage) is analyzed to account for the accumulation of family size over a woman's reproductive lifetime and differences in exposure time. Incorporating this offset allows the model to estimate birth rates rather than the total number of children.To address overdispersion, a Negative Binomial regression with an offset (months since marriage) is also examined. As a result, three main models are analyzed: Poisson regression without an offset, Poisson regression with an offset, and Negative Binomial regression with an offset.

Finally, the significance of predictors in each regression model will be assessed using confidence intervals and p-values, while residual plots will be used to evaluate the extent of variation in the response variable.

$log$

# Results

```{r figure 1, echo=FALSE}
#install.packages("ggplot2")
install.packages("gridExtra")
library(ggplot2)
library(gridExtra)
load("/cloud/project/Assignment1/portugal.RData")
ggplot(portugal, aes(x =literacy, y = children, fill = literacy)) +
  geom_boxplot() +
  labs(title = "Family Size by Literacy",
       x = "Literacy (x)",
       y = "Family Size (Mean Children)") +
  theme_minimal() 


```

```{r, echo=FALSE}
ggplot(portugal, aes(x = children, fill = literacy)) +
    geom_histogram(aes(y = after_stat(density)), binwidth = 0.5, position = "dodge", color = "black") +  # Default counts
    labs(title = "Family Size by Literacy Status",
         x = "Number of Children",
         y = "Density",
         fill = "Literacy Status") +
    theme_minimal() 
    #scale_fill_manual(values = c("blue", "red"))

```

```{r}
ggplot(portugal, aes(x = children, fill = ageMarried)) +
    geom_density(alpha = 0.5) +
    facet_wrap(~ ageMarried) +  # Creates 7 subplots
    labs(title = "Density of Family Size by Category",
         x = "Number of Children",
         y = "Density") +
    theme_minimal() +
    scale_fill_brewer(palette = "Set3")

```
